library(shiny)
ui <- fluidPage(
  titlePanel("StarWars Characters"),
  sidebarLayout(
    sidebarPanel(
      numericInput("height", "Minimum Height:", 0, min = 1, max = 1000),
      numericInput("weight", "Minimum Weight:", 0, min = 1, max = 1000),
      hr(),
      helpText("Data from `dplyr` package.")
    ),
    mainPanel(
      plotOutput("distPlot")
    )
  )
)



server <- function(input, output) {
  output$distPlot <- renderPlot({
    starwars_filtered <- starwars %>%
      filter(height > input$height & mass > input$weight)
    ggplot(starwars_filtered, aes(x = height, y = mass, fill = gender)) +
      geom_point(pch = 21, size = 5) +
      theme_light() +
      geom_smooth(method = "lm") +
      labs(x = "Height", y = "Mass",
           title = "StarWars Characters Mass vs Height Comparison",
           subtitle = "Each dot represents a separate character",
           caption = "Data Source: starwars (dplyr)")
  })
  
}

shinyApp(ui = ui, server = server)
